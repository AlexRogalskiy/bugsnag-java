sudo: required
addons:
  apt:
    packages:
    - openjdk-7-jre
    - openjdk-6-jre
language: java
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - $HOME/.gradle/caches/
  - $HOME/.gradle/wrapper/
install: ./gradlew :assemble

jobs:
  include:
  - stage: test
    jdk: openjdk8
    script: ./gradlew check :test
  - stage: test
    jdk: openjdk7
    install:
    - jdk_switcher use openjdk7
    - ./gradlew :assemble
    script: ./gradlew :test
  - stage: test
    jdk: oraclejdk9
    script: ./gradlew check :test
  - stage: test
    jdk: oraclejdk8
    script: ./gradlew check :test
